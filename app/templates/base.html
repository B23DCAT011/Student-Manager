<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Quản lý sinh viên{% endblock %}</title>

  <!-- CSS sẽ thêm sau -->
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .header {
      border-bottom: 2px solid #007bff;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    .btn {
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 4px;
      display: inline-block;
      margin: 5px;
    }

    .btn-primary {
      background-color: #007bff;
      color: white;
    }

    .btn-success {
      background-color: #28a745;
      color: white;
    }

    .btn-danger {
      background-color: #dc3545;
      color: white;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
  </style>
</head>

<body>
  <!-- User info bar (nếu đã đăng nhập) -->
  {% if current_user.is_authenticated %}
  <div style="background: #f8f9fa; padding: 12px 0; border-bottom: 1px solid #dee2e6;">
    <div
      style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 20px;">
      <div style="display: flex; align-items: center; gap: 15px;">
        <span style="color: #495057;">
          👋 Xin chào, <strong>{{ current_user.username }}</strong>
        </span>
        <span style="
          background: {% if current_user.role == 'teacher' %}#28a745{% else %}#007bff{% endif %}; 
          color: white; 
          padding: 4px 8px; 
          border-radius: 12px; 
          font-size: 12px;
          font-weight: bold;
        ">
          {% if current_user.role == 'teacher' %}👨‍🏫 Giáo viên{% else %}🎓 Sinh viên{% endif %}
        </span>
      </div>
      <div>
        <span style="color: #6c757d; font-size: 14px; margin-right: 15px;">
          Đăng nhập: {{ current_user.last_login.strftime('%d/%m/%Y %H:%M') if current_user.last_login else 'N/A' }}
        </span>
        <a href="{{ url_for('auth.logout') }}" style="color: #dc3545; text-decoration: none; font-weight: bold;">
          🚪 Đăng xuất
        </a>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="container">
    <div class="header">
      <a href="{% if current_user.is_authenticated %}{% if current_user.role == 'teacher' %}{{ url_for('home.index') }}{% else %}{{ url_for('auth.student_portal') }}{% endif %}{% else %}/{% endif %}"
        style="text-decoration: none; color: #007bff; font-size: 24px; font-weight: bold;">
        <h1>🎓 Hệ thống quản lý sinh viên</h1>
      </a>

      <!-- Navigation theo role -->
      {% if current_user.is_authenticated %}
      {% if current_user.role == 'teacher' %}
      <!-- Menu cho giáo viên (full access) -->
      <nav>
        <a href="{{ url_for('grades.dashboard') }}" class="btn btn-primary"> Dashboard điểm</a>
        <a href="{{ url_for('grades.list_thanh_phan') }}" class="btn btn-secondary">📋 Điểm thành phần</a>
        <a href="{{ url_for('grades.list_cuoi_ky') }}" class="btn btn-secondary">🎯 Điểm cuối kỳ</a>
        <a href="/students/list" class="btn btn-secondary">📚 Sinh viên</a>
        <a href="/teachers/list" class="btn btn-secondary">👨‍🏫 Giáo viên</a>
        <a href="/academics" class="btn btn-secondary">🏛️ Học thuật</a>
      </nav>
      {% else %}
      <!-- Menu cho sinh viên (limited) -->
      <nav>
        <a href="{{ url_for('auth.student_portal') }}" class="btn btn-primary">🎓 Xem điểm của tôi</a>
        <a href="{{ url_for('chatbot.process') }}" class="btn btn-success">🤖 AI Assistant</a>
        <p style="color: #6c757d; font-size: 14px; margin: 10px 0 0 0;">
          💡 Sinh viên có thể xem điểm cá nhân và chat với AI
        </p>
      </nav>
      {% endif %}
      {% else %}
      <!-- Menu cho khách (chưa đăng nhập) -->
      <nav>
        <a href="{{ url_for('auth.login') }}" class="btn btn-primary">� Đăng nhập</a>
        <p style="color: #6c757d; font-size: 14px; margin: 10px 0 0 0;">
          Vui lòng đăng nhập để sử dụng hệ thống
        </p>
      </nav>
      {% endif %}
    </div>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div style="margin-bottom: 20px;">
      {% for category, message in messages %}
      <div style="
              padding: 12px 15px; 
              margin-bottom: 10px; 
              border-radius: 5px; 
              border-left: 4px solid;
              {% if category == 'error' %}
                background: #f8d7da; 
                color: #721c24; 
                border-color: #dc3545;
              {% elif category == 'success' %}
                background: #d4edda; 
                color: #155724; 
                border-color: #28a745;
              {% else %}
                background: #d1ecf1; 
                color: #0c5460; 
                border-color: #17a2b8;
              {% endif %}
            ">
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <main>
      {% block content %}{% endblock %}
    </main>
  </div>
  1
  1
</body>

</html>